---
title: "PostGIS 2.3‰ª•Èôç„ÅØ„Éú„É≠„Éé„Ç§Âõ≥„Çí‰Ωú„ÇãÈñ¢Êï∞„ÇíÊåÅ„Å£„Å¶„ÅÑ„Çã„ÅÆ„ÅßÁã¨Ëá™„Å´‰Ωú„ÇãÂøÖË¶Å„ÅåÁÑ°„ÅÑ"
emoji: "üòÄ"
type: "tech"
topics: [PostGIS, OSM]
published: true
---
# ÂÖà„Å´„Åæ„Å®„ÇÅ

Ââç„ÅÆË®ò‰∫ã„Åß„ÄÅ„Éâ„É≠„Éç„Éº‰∏âËßíÂΩ¢ÂàÜÂâ≤„Åã„Çâ„Éú„É≠„Éé„Ç§Âõ≥„Çí‰Ωú„ÇãÊñπÊ≥ï„ÇíÁ∑®„ÅøÂá∫„Åó„ÅüÊñπ„Åå„ÅÑ„Çâ„Å£„Åó„ÇÉ„Å£„Åü„Åì„Å®„Çí„ÅîÁ¥π‰ªã„Åó„Åæ„Åó„Åü„ÄÇ

„Åù„Çå„Å®„ÅØ„Åæ„Å£„Åü„ÅèÁï∞„Å™„Çã„É©„Ç§„É≥„Åß„ÄÅ2.3.0„Åß [ST_VoronoiLines](http://cse.naro.affrc.go.jp/yellow/pgisman/2.4.0/ST_VoronoiLines.html) „Å® [ST_VoronoiPolygons](http://cse.naro.affrc.go.jp/yellow/pgisman/2.4.0/ST_VoronoiPolygons.html) „Å®„ÅåËøΩÂä†„Åï„Çå„Å¶„ÅÑ„Åæ„Åô„ÄÇ

# ST_VoronoiPolygons„ÇíÂÆüË°å„Åó„Å¶„Åø„Åæ„Åó„Çá„ÅÜ

ST_VoronoiPolygon()„ÅÆÂºïÊï∞„ÅØ„Éû„É´„ÉÅ„Éù„Ç§„É≥„Éà„Åß„Åô„ÄÇ„Ç∑„É≥„Ç∞„É´„ÅÆ„Éù„Ç§„É≥„Éà„ÇíÊåÅ„Å£„Å¶„ÅÑ„ÇãÂ†¥Âêà„Å´„ÅØ„ÄÅ``ST_Collect()``„Åß„Éû„É´„ÉÅ„Éù„Ç§„É≥„Éà„Å´„Åæ„Å®„ÇÅ„Å¶„Åã„Çâ‰∏é„Åà„Å¶„Åè„Å†„Åï„ÅÑ„ÄÇ

```
db=# SELECT ST_AsText(
  ST_VoronoiPolygons(
    'MULTIPOINT(12 5, 5 7, 2 5, 19 6, 19 13, 15 18, 10 20, 4 18, 0 13, 0 6, 4 1, 10 0, 15 1, 19 6)'                                                               )                  
);
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          st_astext                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          
---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 GEOMETRYCOLLECTION(POLYGON((-20 33.1,-20 40,0 40,9.02941176470588 12.9117647058824,5.62244897959184 12.6020408163265,-20 33.1)),POLYGON((0 40,20.9 40,9.92666666666667 12.5666666666667,9.02941176470588 12.9117647058824,0 40)),POLYGON((-20 -14.1,-20 9.5,1.9 9.5,2.21428571428571 7.92857142857143,-1.33333333333333 0.833333333333333,-20 -14.1)),POLYGON((3.58333333333333 -20,-20 -20,-20 -14.1,-1.33333333333333 0.833333333333333,4.875 3.9375,7.5 3.5,3.58333333333333 -20)),POLYGON((-20 9.5,-20 33.1,5.62244897959184 12.6020408163265,1.9 9.5,-20 9.5)),POLYGON((1.9 9.5,5.62244897959184 12.6020408163265,9.02941176470588 12.9117647058824,9.92666666666667 12.5666666666667,10.2835051546392 12.2422680412371,7.85897435897436 3.75641025641026,7.5 3.5,4.875 3.9375,2.21428571428571 7.92857142857143,1.9 9.5)),POLYGON((-1.33333333333333 0.833333333333333,2.21428571428571 7.92857142857143,4.875 3.9375,-1.33333333333333 0.833333333333333)),POLYGON((16.6 -20,3.58333333333333 -20,7.5 3.5,7.85897435897436 3.75641025641026,12.195652173913 2.02173913043478,16.6 -20)),POLYGON((7.85897435897436 3.75641025641026,10.2835051546392 12.2422680412371,12.3358208955224 11.7686567164179,14.9285714285714 9.5,15.6290322580645 4.59677419354839,12.195652173913 2.02173913043478,7.85897435897436 3.75641025641026)),POLYGON((39 9.5,39 -14.1,15.6290322580645 4.59677419354839,14.9285714285714 9.5,39 9.5)),POLYGON((20.9 40,39 40,39 33.1,12.3358208955224 11.7686567164179,10.2835051546392 12.2422680412371,9.92666666666667 12.5666666666667,20.9 40)),POLYGON((39 -14.1,39 -20,16.6 -20,12.195652173913 2.02173913043478,15.6290322580645 4.59677419354839,39 -14.1)),POLYGON((39 33.1,39 9.5,14.9285714285714 9.5,12.3358208955224 11.7686567164179,39 33.1)))
(1 Ë°å)
```

„Ç∏„Ç™„É°„Éà„É™„Ç≥„É¨„ÇØ„Ç∑„Éß„É≥„ÅåÂá∫„Åü„ÅÆ„Åß„ÄÅ„Éù„É™„Ç¥„É≥„Å†„Åë„ÇíÊäΩÂá∫„Åô„Çã``ST_CollectionExtract()``„Çí‰Ωø„Å£„Å¶„Åø„Åæ„Åô„ÄÇ

```
db=# SELECT ST_AsText(
  ST_CollectionExtract(
    ST_VoronoiPolygons(
      'MULTIPOINT(12 5, 5 7, 2 5, 19 6, 19 13, 15 18, 10 20, 4 18, 0 13, 0 6, 4 1, 10 0, 15 1, 19 6)'
    ),
    3
  )
);

                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         st_astext                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          
--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 MULTIPOLYGON(((-20 33.1,-20 40,0 40,9.02941176470588 12.9117647058824,5.62244897959184 12.6020408163265,-20 33.1)),((0 40,20.9 40,9.92666666666667 12.5666666666667,9.02941176470588 12.9117647058824,0 40)),((-20 -14.1,-20 9.5,1.9 9.5,2.21428571428571 7.92857142857143,-1.33333333333333 0.833333333333333,-20 -14.1)),((3.58333333333333 -20,-20 -20,-20 -14.1,-1.33333333333333 0.833333333333333,4.875 3.9375,7.5 3.5,3.58333333333333 -20)),((-20 9.5,-20 33.1,5.62244897959184 12.6020408163265,1.9 9.5,-20 9.5)),((1.9 9.5,5.62244897959184 12.6020408163265,9.02941176470588 12.9117647058824,9.92666666666667 12.5666666666667,10.2835051546392 12.2422680412371,7.85897435897436 3.75641025641026,7.5 3.5,4.875 3.9375,2.21428571428571 7.92857142857143,1.9 9.5)),((-1.33333333333333 0.833333333333333,2.21428571428571 7.92857142857143,4.875 3.9375,-1.33333333333333 0.833333333333333)),((16.6 -20,3.58333333333333 -20,7.5 3.5,7.85897435897436 3.75641025641026,12.195652173913 2.02173913043478,16.6 -20)),((7.85897435897436 3.75641025641026,10.2835051546392 12.2422680412371,12.3358208955224 11.7686567164179,14.9285714285714 9.5,15.6290322580645 4.59677419354839,12.195652173913 2.02173913043478,7.85897435897436 3.75641025641026)),((39 9.5,39 -14.1,15.6290322580645 4.59677419354839,14.9285714285714 9.5,39 9.5)),((20.9 40,39 40,39 33.1,12.3358208955224 11.7686567164179,10.2835051546392 12.2422680412371,9.92666666666667 12.5666666666667,20.9 40)),((39 -14.1,39 -20,16.6 -20,12.195652173913 2.02173913043478,15.6290322580645 4.59677419354839,39 -14.1)),((39 33.1,39 9.5,14.9285714285714 9.5,12.3358208955224 11.7686567164179,39 33.1)))
(1 Ë°å)
```

Ê¨°„ÅÆ„Çà„ÅÜ„Å´„Å™„Çä„Åæ„Åô„ÄÇ

![ST_VoronoiPolygons„ÅÆÁµêÊûú](https://github.com/boiledorange73/zenn-content/raw/main/articles-images/0017/1.png)

Ââç„ÅÆË®ò‰∫ã„ÅÆÁîªÂÉè„Å®ÊØîËºÉ„Åó„Å¶„Åø„Å¶‰∏ã„Åï„ÅÑ„ÄÇ

„ÄåÂÖ®„ÅèÈÅï„ÅÜ„Åò„ÇÉ„Å™„ÅÑ„Åã„Äç„Å®ÊÄù„Çè„Çå„Çã„Åã„ÇÇÁü•„Çå„Åæ„Åõ„Çì„Åå„ÄÅ„ÅÑ„ÅÑ„Åà„ÄåÂêå„Åò„Äç„Åß„Åô„ÄÇ„Éú„É≠„Éé„Ç§Âõ≥„ÅØÊîæ„Å£„Å¶„Åä„Åè„Å®ÁÑ°ÈôêÈÅ†„Åæ„Åß‰º∏„Å∞„Åõ„Çã„Å®„Åì„Çç„Çí„ÄÅ„ÅÇ„ÇãÁ®ãÂ∫¶„ÅÆÁØÑÂõ≤„ÅßÂàá„Å£„Å¶„ÅÑ„Åæ„Åô„ÄÇ„Åù„ÅÆÂàá„ÇäÊñπ„ÅåÈï∑ÊñπÂΩ¢„Å´„Åó„Åü„ÅãÂá∏ÂåÖ„Å´„Åó„Åü„Åã„ÅÆÈÅï„ÅÑ„Å†„Åë„Åß„Åô„ÄÇ

# ST_VoronoiLines„ÅÆÊñπ„ÇÇ„ÇÑ„Å£„Å¶„Åø„Åæ„Åó„Çá„ÅÜ

Âêå„Åò„Çà„ÅÜ„Å´„ÄÅ``ST_VoronoiLines()``„ÅÆÊñπ„ÇÇ„ÇÑ„Å£„Å¶„Åø„Åæ„Åó„Çá„ÅÜ„ÄÇ

```
db=# SELECT ST_AsText(
  ST_VoronoiLines(
    'MULTIPOINT(12 5, 5 7, 2 5, 19 6, 19 13, 15 18, 10 20, 4 18, 0 13, 0 6, 4 1, 10 0, 15 1, 19 6)'
  )
);
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        st_astext                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        
-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 MULTILINESTRING((0 40,9.02941176470588 12.9117647058824),(9.02941176470588 12.9117647058824,5.62244897959184 12.6020408163265),(5.62244897959184 12.6020408163265,-20 33.1),(20.9 40,9.92666666666667 12.5666666666667),(9.92666666666667 12.5666666666667,9.02941176470588 12.9117647058824),(-20 9.5,1.9 9.5),(1.9 9.5,2.21428571428571 7.92857142857143),(2.21428571428571 7.92857142857143,-1.33333333333333 0.833333333333333),(-1.33333333333333 0.833333333333333,-20 -14.1),(-1.33333333333333 0.833333333333333,4.875 3.9375),(4.875 3.9375,7.5 3.5),(7.5 3.5,3.58333333333333 -20),(5.62244897959184 12.6020408163265,1.9 9.5),(9.92666666666667 12.5666666666667,10.2835051546392 12.2422680412371),(10.2835051546392 12.2422680412371,7.85897435897436 3.75641025641026),(7.85897435897436 3.75641025641026,7.5 3.5),(4.875 3.9375,2.21428571428571 7.92857142857143),(7.85897435897436 3.75641025641026,12.195652173913 2.02173913043478),(12.195652173913 2.02173913043478,16.6 -20),(10.2835051546392 12.2422680412371,12.3358208955224 11.7686567164179),(12.3358208955224 11.7686567164179,14.9285714285714 9.5),(14.9285714285714 9.5,15.6290322580645 4.59677419354839),(15.6290322580645 4.59677419354839,12.195652173913 2.02173913043478),(14.9285714285714 9.5,39 9.5),(39 -14.1,15.6290322580645 4.59677419354839),(39 33.1,12.3358208955224 11.7686567164179))
(1 Ë°å)
```

Âõ≥„ÅßÁ§∫„Åô„Å®Ê¨°„ÅÆ„Çà„ÅÜ„Å´„Å™„Çä„Åæ„Åô„ÄÇ

![ST_VoronoiLines„ÅÆÁµêÊûú](https://github.com/boiledorange73/zenn-content/raw/main/articles-images/0017/2.png)

„Éù„É™„Ç¥„É≥„Å®ÈÅï„ÅÑ„ÄÅÂêÑ„Çµ„Ç§„Éà„ÇíÈñâ„Åò„Åü„É©„Ç§„É≥„Çπ„Éà„É™„É≥„Ç∞„Å´„Åô„ÇãÂøÖË¶Å„ÅåÁÑ°„ÅÑ„ÅÆ„Åß„ÄÅ„Éú„É≠„Éé„Ç§Ëæ∫„Å†„Åë„ÅåÂá∫Âäõ„Åï„Çå„Å¶„ÅÑ„Åæ„Åô„ÄÇ

# „Åä„Çè„Çä„Å´

‰ªäÊõ¥„Å™„Åå„Çâ„Åß„Åô„Åå„ÄÅ2.3.0„Åã„ÇâËøΩÂä†„Åï„Çå„ÅüÈñ¢Êï∞ ``ST_VoronoiPolygons()`` „Å® ``ST_VoronoiLines()`` „Å´„Å§„ÅÑ„Å¶„ÄÅ„ÅîÁ¥π‰ªã„Åó„Åæ„Åó„Åü„ÄÇ

„Éú„É≠„Éé„Ç§ÂàÜÂâ≤„ÅØ„ÄÅÊúÄ„ÇÇËøë„ÅÑ„Éù„Ç§„É≥„Éà„ÇíÂÖ±Êúâ„Åô„ÇãÈ†òÂüü„ÇíË®àÁÆó„Åó„Å¶„Åè„Çå„Çã„ÇÇ„ÅÆ„Åß„Åô„ÄÇ„Åü„Å®„Åà„Å∞„ÄÅ„Éù„Ç§„É≥„Éà„ÇíÂ≠¶Ê†°„Å®„Å®„Çâ„Åà„Åü„Çâ„ÄÅ„Éú„É≠„Éé„Ç§ÂàÜÂâ≤„ÅßÂæó„Çâ„Çå„Çã„Éù„É™„Ç¥„É≥„ÅØ„ÄÅÈÅìË∑ØË®≠ÁΩÆÁä∂Ê≥Å„ÇíÂÖ®„ÅèËÄÉÊÖÆ„Åó„Åæ„Åõ„Çì„Åå„ÄÅ„ÅÑ„Å°„Åä„ÅÜ„ÄåÊ†°Âå∫„Äç„Å´„Å™„Çã„Åß„Åó„Çá„ÅÜ„ÄÇ„Åù„ÅÆ‰ªñ„Å´„ÇÇ„ÄÅÁü•„Å£„Å¶„ÅÑ„Åü„ÇâÊÑèÂ§ñ„Å®‰Ωø„Åà„Çã„Åã„ÇÇÁü•„Çå„Åæ„Åõ„Çì„ÄÇ

# Êú¨Ë®ò‰∫ã„ÅÆ„É©„Ç§„Çª„É≥„Çπ

![„ÇØ„É™„Ç®„Ç§„ÉÜ„Ç£„Éñ„Éª„Ç≥„É¢„É≥„Ç∫„Éª„É©„Ç§„Çª„É≥„Çπ](https://i.creativecommons.org/l/by/4.0/88x31.png)
„Åì„ÅÆË®ò‰∫ã„ÅØ [„ÇØ„É™„Ç®„Ç§„ÉÜ„Ç£„Éñ„Éª„Ç≥„É¢„É≥„Ç∫ Ë°®Á§∫ 4.0 ÂõΩÈöõ „É©„Ç§„Çª„É≥„Çπ](http://creativecommons.org/licenses/by/4.0/">) „ÅÆ‰∏ã„Å´Êèê‰æõ„Åï„Çå„Å¶„ÅÑ„Åæ„Åô„ÄÇ
